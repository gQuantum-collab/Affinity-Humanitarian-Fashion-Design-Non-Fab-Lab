#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Ensure dependencies are installed (frozen lockfile to match CI)
pnpm install --frozen-lockfile

# Enforce sovereign IP marks
python3 ops/ipmarks/runner.py
if ! git diff --quiet; then
  echo "‚ùå Sovereign marks runner made changes. Push aborted. Commit them first."
  exit 1
fi

# Build and run tests
pnpm build
pytest ops/tests -q
